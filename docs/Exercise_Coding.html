<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Andreas Handel" />

<meta name="date" content="2019-08-06" />

<title>Coding Exercise</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>




<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">MADA Course</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    General Information
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./Course_Syllabus.html">Syllabus</a>
    </li>
    <li>
      <a href="./Course_Schedule.html">Schedule</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Modules
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">1. Introduction</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./1a_Course_Introduction.html">Course intro</a>
        </li>
        <li>
          <a href="./1b_Topic_Introduction.html">Topic intro</a>
        </li>
        <li>
          <a href="./1c_Teaching_and_Learning.html">Some Teaching Comments</a>
        </li>
        <li>
          <a href="./1d_Assessment.html">Assessment</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">2. Coures Tools</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./2a_RandRStudio.html">R and Rstudio</a>
        </li>
        <li>
          <a href="./2b_Github.html">GitHub</a>
        </li>
        <li>
          <a href="./2c_ToolsforReproducibility.html">RMarkdown &amp; Co</a>
        </li>
        <li>
          <a href="./2d_Assessment.html">Assessment</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">3. R basics</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./3a_RBasics.html">R basics</a>
        </li>
        <li>
          <a href="./3b_Assessment.html">Assessment</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-header">4. Data analysis overview</li>
    <li class="dropdown-header">5. Pondering and getting data</li>
    <li class="dropdown-header">6. Wrangling data</li>
    <li class="dropdown-header">7. Visualizing data</li>
    <li class="dropdown-header">8. Exploring data</li>
    <li class="dropdown-header">9. Model performance assessment</li>
    <li class="dropdown-header">10. Model quality assessment</li>
    <li class="dropdown-header">11. GLM and feature selection</li>
    <li class="dropdown-header">12. Tree-based models and tuning</li>
    <li class="dropdown-header">13. Various ML models</li>
    <li class="dropdown-header">14. A complete analysis</li>
    <li class="dropdown-header">15. Deep learning, AI and Big data</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./Exercise_Introducing_Ourselves.html">Introducing ourselves</a>
    </li>
    <li>
      <a href="./Exercise_Coding.html">R Coding</a>
    </li>
    <li>
      <a href="./Exercise_Tidy_Tuesday.html">TidyTuesday</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Project
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./Project_Information.html">Project information</a>
    </li>
  </ul>
</li>
<li>
  <a href="Resources.html">Resources</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Coding Exercise</h1>
<h4 class="author">Andreas Handel</h4>
<h4 class="date">2019-08-06</h4>

</div>


<div id="overview" class="section level1">
<h1>Overview</h1>
<p>This project asks you to write a bit of code to do a simple data analysis, we’ll be using both some commands from base R and from the tidyverse, so we can compare and contrast. We’ll also be using the Github workflow, so we can practice that one some more.</p>
</div>
<div id="project-setup" class="section level1">
<h1>Project setup</h1>
<ul>
<li>Go to the class organization <a href="https://github.com/epid8060fall2019">Github website</a> and create a new repository (press the green <em>New</em> button) named <em>YOURNAME-coding</em>. You can leave the description empty. Choose if you want the repository to be private or public. Check the box <em>Initialize this repository with a README</em>. Set the <em>.gitignore</em> option to <code>R</code>, you can leave the license at <em>none</em>. We won’t make this exercise into a website, so we can skip all the things about <em>Github pages</em> we did in the <em>Introducing Ourselves</em> exercise.</li>
<li>Clone the repository to your local computer (using Gitkraken or whatever software/method you decided to use for this). I recommend placing the repository inside the folder you made for the class. <strong>Make sure you do not stick Github repositories inside other repositories, that can lead to Github breaking</strong>. And remember that repository folders should not be synced with some other software (e.g. Dropbpox).</li>
<li>Open RStudio on your computer. Choose <em>File</em>, <em>New Project</em>, <em>Existing Directory</em> and then choose as directory the location on your computer where you cloned your repository in the previous step. If things work, you should see in the bottom right window of RStudio (at least) 2 files, one with .Rproj ending and a README.md.</li>
<li>Just to practice, let’s update the Readme file. Click to open the README.md file. Replace the text with something else, e.g. “YOURNAME first R coding exercise” or something of that type. It doesn’t matter what you write exactly, we are just practicing editing the Readme file.</li>
</ul>
</div>
<div id="r-content-creation" class="section level1">
<h1>R content creation</h1>
<p><em>It is best to call things which store values <code>objects</code> and use <code>variable</code> for a data variable, i.e. usually a column. However, it is common to refer to things that store values as <code>variable</code> as well. Because of that, I sometimes use that terminology inadvertently too. So if I talk about variable, you need to determine from the context if I mean a certain variable in the data, i.e. a predictor variable, or a variable in R that stores some content, i.e. an object.</em></p>
<div id="getting-started" class="section level2">
<h2>Getting started</h2>
<ul>
<li>We’ll use an R Notebook for this exercise. It is a type of R Markdown document, you can <a href="https://bookdown.org/yihui/rmarkdown/notebook.html">learn more here</a>. Choose <em>File</em>, <em>New File</em>, <em>R Notebook</em>. A new file shows up. Read through the provided information, then delete all but the YAML header. Give it a title like <em>YOURNAME Coding Exercise</em>. Now you are ready to write some R code!</li>
<li><strong>Remember to put a lot of commentary into your code/file! As a rule of thumb, I suggest around half of what you write should be comments explaining what you do and why. This is very helpful especially as you start learning to write code. And it makes it much easier for your future selves and others to follow.</strong></li>
</ul>
</div>
<div id="loading-and-checking-data" class="section level2">
<h2>Loading and checking data</h2>
<ul>
<li>We’ll look at and play with some data from the <a href="https://simplystatistics.org/2018/01/22/the-dslabs-package-provides-datasets-for-teaching-data-science/"><code>dslabs</code> package</a>. Write a code chunk that installs and loads the package.</li>
<li>We’ll look at the <code>gapminder</code> dataset from <code>dslabs</code>. Write a code chunk that pulls up the help page for the data to see what it contains. Then use the <code>str</code> and <code>summary</code> commands to take a look at the data. Use the <code>class</code> function to check what type of object this is.</li>
</ul>
</div>
<div id="processing-data" class="section level2">
<h2>Processing data</h2>
<ul>
<li>Using <em>base R notation</em> (no <code>dplyr</code> allowed yet), assign only the African countries to a new object/variable called <code>africadata</code>. Run <code>str</code> and <code>summary</code> on the new object you created. You should now have 2907 observations, down from 10545. You might also notice that all different factor categories are still kept in the <code>continent</code> (and other) variables, but show 0. R does not automatically remove levels of factors even if they are empty. We don’t have to worry about that just now, but something to keep in mind, it can sometimes lead to strange behavior.</li>
<li>Again using <em>base R notation</em>, take the <code>africadata</code> object and make 2 new variables (name them whatever you want), one that contains only <code>infant_mortality</code> and <code>life_expectancy</code> and onethat contains only <code>population</code> and <code>life_expectancy</code>. You should have 2 new objects/variables with 2907 rows and 2 columns. Use the <code>str</code> and <code>summary</code> commands tp take a look at both variables.</li>
</ul>
</div>
<div id="plotting" class="section level2">
<h2>Plotting</h2>
<ul>
<li>Using the new variables you created, plot life expectancy as a function of infant mortality and as a function of population size. Make 2 separate plots. Use base R plot commands, i.e. the <code>plot</code> function. Plot the data as points. For the plot with population size on the x-axis, set this axis to a log scale.</li>
</ul>
<p>You should see a negative correlation between infant mortality and life expectancy. That one makes sense. You should also see a positive correlation between population size and life expectancy. In both plots, especially the 2nd one, you will see ‘streaks’ of data that seem to go together. Can you figure out what is going on here? Take another look at the <code>africadata</code> data we generated, which should give you a hint of what’s happening.</p>
</div>
<div id="more-data-processing" class="section level2">
<h2>More data processing</h2>
<ul>
<li>I’m sure you realized that the pattern we see in the data is due to the fact that we have different years for individual countries, and that over time these countries increase in population size and also life expectancy. Let’s pick only one year and see what patterns we find there. We want a year for which we have the most data. You might have noticed that in <code>africadata</code>, there are 226 NA (i.e. missing values) for infant mortality. Write some base R code that figures out what the corresponding years are for which infant mortality data is missing. You should find that there is missing up to 1981 and then again for 2016. So we’ll avoid those years and go with 2000 instead.</li>
<li>Let’s create a new object by extracting only year 2000 from the <code>africadata</code> object. You should end up with 51 observations and 9 variables.</li>
</ul>
</div>
<div id="more-plotting" class="section level2">
<h2>More plotting</h2>
<ul>
<li>Let’s use base R plotting again and do the same 2 plots again, this time only for year 2000. We don’t need to create those intermediate objects that only contained the variables we want to plot. We did that just for practice.</li>
</ul>
<p>Based on those plots, there seems to still be a negative correlation between infant mortality and life expectancy, and no noticeable correlation between population size and life expectancy. Let’s apply some statistics to that.</p>
</div>
<div id="a-simple-fit" class="section level2">
<h2>A simple fit</h2>
<ul>
<li>Use the <code>lm</code> function and fit life expectancy as outcome, and either infant mortality or population size as predictor. Save the result from the fit into 2 objects (e.g. <code>fit1</code> and <code>fit2</code>) and apply the <code>summary</code> command to both, which will print various fit results to the screen. Based on the p-values for each fit, what do you conclude?</li>
</ul>
</div>
<div id="beyond-base-r" class="section level2">
<h2>Beyond base R</h2>
<p>So far, we written code that didn’t require any additional packages. We only loaded the <code>dslabs</code> package to get the data. While one can do a lot with base R, it is at times tedious to write code. Especially for data analysis tasks, there are many packages available that make our coding lives easier. We’ll use some now.</p>
<ul>
<li>Write code to load the <code>tidyverse</code> collection of packages and the <code>skimr</code> package. If you don’t have them installed, do so. This will likely install a lot of packages and take a while.</li>
<li>Use the <code>glimpse</code> function from <code>dplyr</code> and the <code>skim</code> function from the <code>skimr</code> package to look at the <code>gapminder</code> object.</li>
<li>Use the <code>filter</code> and <code>select</code> functions from <code>dplyr</code> to extract only the african countries from the <code>gapminder</code> object and then keep only the variables <code>infant_mortality</code>, <code>life_expectancy</code>, <code>population</code> and <code>country</code>.</li>
<li>Make 2 plots using <code>ggplot</code> for life expectancy as function of infant mortality and population. Also give each country a separate color in the plot.</li>
<li>Write code that uses the gapminder object, pulls out data for africa and year 2000 and creates a <code>ggplot</code> for <code>life_expectancy</code> as function of <code>infant_mortality</code>, with a linear model fit added.</li>
</ul>
</div>
</div>
<div id="sending-updates-to-github" class="section level1">
<h1>Sending updates to Github</h1>
<ul>
<li>Once you are done with your exercise, under the <code>Run</code> menu (top left) select <code>Restart R and Run all Chunks</code>. Make sure no error messages show up.</li>
</ul>
<p>sure the 2 files (README.md and especially index.Rmd/index.html) look the way you want. Make changes until everything works. Once you are happy with things, close RStudio. * Go to the program you use for Github (I will assume that it’s GitKraken, if you use something else the details might vary). In the top right of Gitkraken, there should be a notification about changed files. Click <em>view changes</em>, then <em>Stage</em>. Write a commit message, commit the changes. You should see the <em>master</em> with the computer symbol be above the one with some random logo. That means your local repository is ahead of the one on github.com. To get them in sync, you click the <em>push</em> button. If things work, the two symbols should now be in the same line. * Go back to github.com and to your repository website. Click the link that you added to your Readme file, which should bring you to your new introductory website. <a href="https://epid8060fall2019.github.io/andreashandel-introduction/">Here is mine as an example</a>.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
